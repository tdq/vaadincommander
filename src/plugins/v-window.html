<link rel="import" href="../v-plugin.html">

<script>
    class VWindow extends VPlugin { 
        drawWindow(x, y, width, height, title = null) {
			const borderX = x + width - 1;
			const borderY = y + height - 1;

			for (let j = y; j < y + height; ++j) {
				for (let i = x; i < x + width; ++i) {
					if (i == x && j == y) {
                        this.api.writeBufferAt(i, j, {value: '&#9556;', bgcolor: '#00f'});
					} else if ( i == borderX && j == y) {
                        this.api.writeBufferAt(i, j, {value: '&#9559;', bgcolor: '#00f'});
					} else if (i == x && j == borderY) {
                        this.api.writeBufferAt(i, j, {value: '&#9562;', bgcolor: '#00f'});
					} else if (i == borderX && j == borderY) {
                        this.api.writeBufferAt(i, j, {value: '&#9565;', bgcolor: '#00f'});
					} else if (i > x && i < borderX && (j == y || j == borderY)) {
                        this.api.writeBufferAt(i, j, {value: '&#9552;', bgcolor: '#00f'});
					} else if (i == x || i == borderX) {
                        this.api.writeBufferAt(i, j, {value: '&#9553;', bgcolor: '#00f'});
                    } else {
                        this.api.writeBufferAt(i, j, {value: '', bgcolor: '#00f'});
					}
				}
			}

			if (!title) {
				return;
			}

			let length = title.length;

			if (length > width - 2) {
				length = width - 2;
			}

			const start = Math.round(x + (width / 2) - (length / 2));
			this.drawText(start, y, title, '#fff', '#00f', length);
		}

		drawText(x, y, text, color = null, bgcolor = null, length = null) {
			const size = length ? length : text.length;

			for (let i = 0; i < size; ++i) {
                this.api.writeBufferAt(x + i, y, {value: text.charAt(i), color: color, bgcolor: bgcolor});
			}
		}
    }

    window.VC.definePlugin('VWindow', VWindow);
</script>
